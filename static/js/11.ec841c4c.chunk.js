(this.webpackJsonpintelowl=this.webpackJsonpintelowl||[]).push([[11],{558:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"j",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"k",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"h",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"i",(function(){return b})),n.d(t,"f",(function(){return j})),n.d(t,"a",(function(){return f}));var a=n(15),c={file:"#ed896f",observable:"#42796f"},r={WHITE:"#FFFFFF",GREEN:"#33FF00",AMBER:"#FFC000",RED:"#FF0033"},s={ip:"#9aa66c",url:"#7da7d3",domain:"#8070ed",hash:"#ed896f",generic:"#733010"},i={WHITE:"TLP: use all analyzers",GREEN:"TLP: disable analyzers that could impact privacy",AMBER:"TLP: disable analyzers that could impact privacy and limit access to my organization",RED:"TLP: disable analyzers that could impact privacy, limit access to my organization and do not use any external service"},l={pending:"light",running:"secondary",killed:"gray",reported_with_fails:"warning",reported_without_fails:"success",failed:"danger"},o=Object(a.a)(Object(a.a)({},l),{pending:"light",running:"secondary",killed:"gray",success:"success",failed:"danger"}),u=["pending","running","reported_with_fails","reported_without_fails","killed","failed"],d=["PENDING","RUNNING","KILLED","SUCCESS","FAILED"],b=Object.keys(r),j=Object.keys(s),f=j.concat("file")},560:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(15),c=n(60),r=(n(1),n(527)),s=n(7),i=["tag"];function l(e){var t=e.tag,n=Object(c.a)(e,i);return Object(s.jsx)(r.a,Object(a.a)(Object(a.a)({style:{backgroundColor:t.color}},n),{},{children:t.label}))}},561:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(15),c=n(60),r=(n(1),n(610)),s=n(7),i=["node"],l=["node"];function o(e){return Object(s.jsx)(r.a,{children:e,components:{em:function(e){e.node;var t=Object(c.a)(e,i);return Object(s.jsx)("i",Object(a.a)({className:"text-code"},t))},a:function(e){e.node;var t=Object(c.a)(e,l);return Object(s.jsx)("a",Object(a.a)({target:"_blank",className:"link-primary"},t))}}})}},562:function(e,t,n){"use strict";n.d(t,"a",(function(){return a.a})),n.d(t,"e",(function(){return c.a})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return x})),n.d(t,"d",(function(){return y}));var a=n(560),c=n(561),r=n(15),s=n(60),i=(n(1),n(5)),l=n.n(i),o=n(33),u=n(64),d=n(102),b=n(520),j=n(558),f=n(7),m=["status","className"],O={pending:o.s,running:d.e,reported_with_fails:o.A,success:o.d,reported_without_fails:o.d,killed:o.r,failed:u.f};function h(e){var t=e.status,n=e.className,a=Object(s.a)(e,m),c=t.toLowerCase(),i=(null===j.h||void 0===j.h?void 0:j.h[c])||"light",u=(null===O||void 0===O?void 0:O[c])||o.e,d=l()("text-".concat(i),n);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(u,Object(r.a)({id:"statusicon-".concat(c),className:d},a)),Object(f.jsx)(b.a,{target:"statusicon-".concat(c),trigger:"hover",className:"p-0 m-0",children:c})]})}h.defaultProps={className:null};var p=["status","className"];function x(e){var t=e.status,n=e.className,a=Object(s.a)(e,p),c=t.toLowerCase(),i=(null===j.h||void 0===j.h?void 0:j.h[c])||"light",o=l()("status-tag","bg-".concat(i),n);return Object(f.jsx)("span",Object(r.a)(Object(r.a)({className:o,title:t},a),{},{children:t.toUpperCase()}))}x.defaultProps={className:null};var g=n(527),v=["value"];function y(e){var t=e.value,n=Object(s.a)(e,v),a="tlptag-badge__".concat(t),c=(null===j.j||void 0===j.j?void 0:j.j[t])||"#dfe1e2",i=(null===j.k||void 0===j.k?void 0:j.k[t])||"invalid";return t?Object(f.jsxs)(g.a,Object(r.a)(Object(r.a)({id:a,style:{backgroundColor:c,color:"black",borderRadius:0,userSelect:"none"}},n),{},{children:[t,Object(f.jsx)(b.a,{target:a,placement:"top",fade:!1,children:i})]})):null}},611:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return pe}));var a=n(15),c=n(32),r=n(21),s=n(17),i=n.n(s),l=n(1),o=n.n(l),u=n(549),d=n(566),b=n(567),j=n(519),f=n(573),m=n(162),O=n(35),h=n(70),p=n(559),x=n.n(p),g=n(33),v=n(22),y=n(5),_=n.n(y),k=n(527),N=n(520),w=n(63),F=n(7);var S=n(558),C=n(562),z=n(163),A=n(132);function E(){var e=Object(A.a)().jobIdStatusMap,t=Object(O.g)(),n=o.a.useCallback((function(e){t.push("/jobs/".concat(e))}),[t]);return Object(F.jsx)("div",{className:"d-flex-start-start flex-wrap",children:Object.entries(e).map((function(e){var t=Object(r.a)(e,2),a=t[0],c=t[1];return Object(F.jsxs)(z.a,{color:c,size:"sm",className:"mb-2 mr-2",onClick:function(){return n(a)},children:["Job #",a]},"recentscans__".concat(a))}))})}var T=n(26),D=n(60),I=n(577),L=n(571),M=n(572),P=n(201),R=n(561),q=["isOpen","toggle","formik"],V=function(e){return[e.analyzersJSON,e.connectors.JSON]};function J(e){var t=e.isOpen,n=e.toggle,c=e.formik,s=Object(D.a)(e,q),i=o.a.useState({}),l=Object(r.a)(i,2),u=l[0],d=l[1],b=Object(P.a)(V),j=Object(r.a)(b,2),f=j[0],m=j[1],O=o.a.useMemo((function(){return Object(a.a)(Object(a.a)({},c.values.analyzers.reduce((function(e,t){var n=t.value;return Object(a.a)(Object(a.a)({},e),{},Object(T.a)({},n,null===f||void 0===f?void 0:f[n].params))}),{})),c.values.connectors.reduce((function(e,t){var n=t.value;return Object(a.a)(Object(a.a)({},e),{},Object(T.a)({},n,null===m||void 0===m?void 0:m[n].params))}),{}))}),[c.values.analyzers,c.values.connectors,f,m]),h=o.a.useMemo((function(){return Object.entries(O).reduce((function(e,t){var n=Object(r.a)(t,2),c=n[0],s=n[1];return Object(a.a)(Object(a.a)({},e),{},Object(T.a)({},c,Object.entries(s).reduce((function(e,t){var n=Object(r.a)(t,2),c=n[0],s=n[1].value;return Object(a.a)(Object(a.a)({},e),{},Object(T.a)({},c,s))}),{})))}),{})}),[O]),p=o.a.useMemo((function(){return Object(a.a)(Object(a.a)({},h),c.values.runtime_configuration)}),[h,c.values.runtime_configuration]);return Object(F.jsxs)(I.a,Object(a.a)(Object(a.a)({autoFocus:!0,zIndex:"1050",size:"xl",isOpen:t,keyboard:!1,scrollable:!0,backdrop:"static",labelledBy:"Edit Runtime Configuration"},s),{},{children:[Object(F.jsx)(L.a,{className:"bg-tertiary",children:"Edit Runtime Configuration"}),Object(F.jsxs)(M.a,{className:"d-flex-start-start bg-body",children:[Object(F.jsxs)(v.e,{className:"bg-darker",children:[Object(F.jsx)("small",{className:"text-muted",children:"Note: Edit this only if you know what you are doing!"}),Object(F.jsx)(v.g,{id:"edit_runtime_configuration-modal",placeholder:p,onChange:d,height:"500px",width:"450px"}),Object(F.jsxs)("div",{className:"mt-2 d-flex align-items-center justify-content-end",children:[Object(F.jsx)(z.a,{onClick:n,size:"sm",color:"",className:"btn-link text-gray",children:"Ignore changes & close"}),Object(F.jsx)(z.a,{disabled:null===u||void 0===u?void 0:u.error,onClick:function(){if(null!==u&&void 0!==u&&u.jsObject){var e=Object.entries(u.jsObject).reduce((function(e,t){var n=Object(r.a)(t,2),c=n[0],s=n[1];return Object.keys(s).length>0&&JSON.stringify(h[c])!==JSON.stringify(s)?Object(a.a)(Object(a.a)({},e),{},Object(T.a)({},c,s)):e}),{});c.setFieldValue("runtime_configuration",e,!1)}n()},size:"sm",color:"info",className:"ml-2",children:"Save & Close"})]})]}),Object(F.jsx)(v.e,{className:"ml-2 bg-darker",children:Object.entries(O).map((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];return Object(F.jsxs)("div",{children:[Object(F.jsx)("h6",{className:"text-secondary",children:n}),Object.entries(a).length?Object(F.jsx)("ul",{children:Object.entries(a).map((function(e){var t=Object(r.a)(e,2),a=t[0],c=t[1];return Object(F.jsxs)("li",{children:[Object(F.jsx)("span",{className:"text-pre",children:a}),"\xa0",Object(F.jsxs)("em",{className:"text-muted",children:["(",c.type,")"]}),Object(F.jsx)("dd",{className:"text-muted",children:Object(R.a)(c.description)})]},"editruntimeconf__".concat(n,"__").concat(a))}))}):Object(F.jsx)("span",{className:"text-muted font-italic",children:"null"})]},"editruntimeconf__".concat(n))}))})]})]}))}var B=n(66),U=n(44),G=n(526),W=n(560),$=n(202),H=["selectedTags","setSelectedTags"],Q=["tagToEdit","onFormSuccess"],Z=function(e){var t={};return e.label?e.label.length<4&&(t.label="This field must be at least 4 characters long"):t.label="This field is required.",t};function K(e){var t=e.selectedTags,n=e.setSelectedTags,a=(Object(D.a)(e,H),o.a.useState(void 0)),s=Object(r.a)(a,2),l=s[0],u=s[1],d=o.a.useCallback((function(){u(void 0),n([])}),[u,n]),b=Object($.a)(o.a.useCallback((function(e){return[e.loading,e.error,e.tags,e.list,e.create]}),[])),j=Object(r.a)(b,5),f=j[0],m=j[1],O=j[2],h=j[3],p=j[4];o.a.useEffect((function(){h()}),[h]);var x=o.a.useMemo((function(){return O.length?O.map((function(e){return{value:e,label:Object(F.jsx)(W.a,{tag:e}),labelOptionExtra:(null===l||void 0===l?void 0:l.id)===e.id?Object(F.jsx)(Y,{tagToEdit:l,onFormSuccess:d}):Object(F.jsx)(g.j,{className:"center pointer",title:"edit",onClick:function(){return u(e)}})}})):[]}),[O,l,u,d]),y=function(){var e=Object(c.a)(i.a.mark((function e(a){var c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p(a,"#1655D3");case 3:c=e.sent,n([].concat(Object(B.a)(t),[{value:c,label:Object(F.jsx)(W.a,{tag:c})}])),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Object(v.L)("Failed!",e.t0.parsedMsg.toString(),"danger");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),_=function(e,t){var a=t.action;"select-option"===a||"deselect-option"===a?n(e):"clear"===a&&n([])};return Object(F.jsx)(v.r,{loading:!1,error:m,render:function(){return Object(F.jsx)(v.u,{id:"scanform-tagsselectinput",isLoading:f,options:x,value:t,onChange:_,onCreateOption:y,isSearchable:!l,onMenuClose:function(){return u(void 0)},formatCreateLabel:function(e){return Object(F.jsxs)("span",{children:["Create New Tag: \xa0",Object(F.jsx)(W.a,{tag:{label:e,color:"#1655D3"}})]})}})}})}function Y(e){var t=e.tagToEdit,n=e.onFormSuccess,s=Object(D.a)(e,Q),l=Object($.a)(o.a.useCallback((function(e){return[e.update,e.create]}),[])),u=Object(r.a)(l,2),d=u[0],b=u[1],j=o.a.useCallback(function(){var e=Object(c.a)(i.a.mark((function e(a,c){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===t||void 0===t||!t.id){e.next=7;break}return e.next=4,d(t.id,a);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,b(a.label,a.color);case 9:e.t0=e.sent;case 10:r=e.t0,setTimeout((function(){return n(t,r)}),250),e.next=17;break;case 14:e.prev=14,e.t1=e.catch(0),Object(v.L)("Failed!",e.t1.parsedMsg.toString(),"danger");case 17:return e.prev=17,c.setSubmitting(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,14,17,20]])})));return function(t,n){return e.apply(this,arguments)}}(),[t,n,d,b]);return Object(F.jsx)(U.a,{children:Object(F.jsx)(h.b,Object(a.a)(Object(a.a)({validateOnMount:!0,validate:Z,initialValues:t,onSubmit:j},s),{},{children:function(e){return Object(F.jsxs)(h.a,{className:"d-flex justify-content-start align-items-center",children:[Object(F.jsx)(m.a,{autoFocus:!0,inline:!0,type:"text",withFeedback:!1,tabIndex:"0",name:"label",placeholder:"label",className:"form-control form-control-sm w-100 bg-dark border-0 rounded-0"}),Object(F.jsx)(m.a,{inline:!0,type:"color",name:"color",className:"form-control form-control-sm w-33 bg-dark border-0 rounded-0"}),Object(F.jsxs)(G.a,{className:"ml-1",children:[Object(F.jsx)(m.b,{withSpinner:!0,disabled:!(e.isValid||e.isSubmitting),color:"tertiary",size:"xs",onClick:e.handleSubmit,children:!e.isSubmitting&&Object(F.jsx)(g.b,{})}),Object(F.jsx)(z.a,{disabled:e.isSubmitting,color:"tertiary",size:"xs",onClick:function(){return n(void 0,void 0)},children:Object(F.jsx)(g.g,{})})]})]})}}))})}Y.defaultProps={tagToEdit:{label:void 0,color:"#ffffff"}};var X=n(27),ee=n.n(X),te=n(594),ne=n.n(te),ae=n(34),ce=A.a.getState().append;function re(e){return se.apply(this,arguments)}function se(){return(se=Object(c.a)(i.a.mark((function e(t){var n,a,c,r,s,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"force_new"===t.check){e.next=7;break}return e.next=4,ie(t);case 4:if(!(n=e.sent)){e.next=7;break}return e.abrupt("return",Promise.resolve(n));case 7:if("file"!==t.classification){e.next=13;break}return e.next=10,de(t);case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,oe(t);case 15:e.t0=e.sent;case 16:if(a=e.t0,console.log(a),"accepted"!==(c=a.data).status&&"running"!==c.status){e.next=24;break}return s=parseInt(c.job_id,10),ce(s,"success"),Object(v.L)("Created new Job with ID #".concat(s,"!"),Object(F.jsxs)("div",{children:[Object(F.jsxs)(v.e,{className:"text-light",children:[Object(F.jsx)("strong",{children:"Analyzers:"}),"\xa0",null===(r=c.analyzers_running)||void 0===r?void 0:r.join(", ")]}),c.connectors_running.length>0&&Object(F.jsxs)(v.e,{className:"text-light",children:[Object(F.jsx)("strong",{children:"Connectors:"}),"\xa0",c.connectors_running.join(", ")]}),c.warnings.length>0&&Object(F.jsxs)(v.e,{className:"bg-accent text-darker",children:[Object(F.jsx)("strong",{children:"Warnings:"}),"\xa0",c.warnings.join(", ")]})]}),"success",!0,1e4),e.abrupt("return",Promise.resolve(s));case 24:return Object(v.L)("Failed!",null===c||void 0===c?void 0:c.message,"danger"),l=new Error("job status ".concat(c.status)),e.abrupt("return",Promise.reject(l));case 29:return e.prev=29,e.t1=e.catch(0),Object(v.L)("Failed!",e.t1.parsedMsg,"danger"),e.abrupt("return",Promise.reject(e.t1));case 33:case"end":return e.stop()}}),e,null,[[0,29]])})))).apply(this,arguments)}function ie(e){return le.apply(this,arguments)}function le(){return(le=Object(c.a)(i.a.mark((function e(t){var n,a,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.analyzers,"file"!==t.classification){e.next=9;break}return e.t2=ne.a,e.next=5,Object(v.P)(t.file);case 5:e.t3=e.sent,e.t1=(0,e.t2)(e.t3),e.next=10;break;case 9:e.t1=ne()(t.observable_name);case 10:return e.t4=e.t1,n={analyzers:e.t0,md5:e.t4},"running_only"===t.check&&(n.running_only="True"),e.prev=13,e.next=16,ee.a.post(ae.f,n);case 16:if(a=e.sent,"not_available"!==(c=a.data).status){e.next=20;break}return e.abrupt("return",0);case 20:return r=parseInt(c.job_id,10),ce(r,"secondary"),Object(v.L)("Found similar scan with job ID #".concat(r),null,"info"),e.abrupt("return",r);case 26:return e.prev=26,e.t5=e.catch(13),e.abrupt("return",Promise.reject(e.t5));case 29:case"end":return e.stop()}}),e,null,[[13,26]])})))).apply(this,arguments)}function oe(e){return ue.apply(this,arguments)}function ue(){return(ue=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={observable_name:t.observable_name,observable_classification:t.classification,analyzers_requested:t.analyzers,connectors_requested:t.connectors,tlp:t.tlp,runtime_configuration:t.runtime_configuration,tags_labels:t.tags_labels},e.abrupt("return",ee.a.post(ae.c,n));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e){return be.apply(this,arguments)}function be(){return(be=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("file",t.file,t.file.name),n.append("file_name",t.file.name),t.tags_labels.map((function(e){return n.append("tags_labels",e)})),t.analyzers.map((function(e){return n.append("analyzers_requested",e)})),t.connectors.map((function(e){return n.append("connectors_requested",e)})),n.append("tlp",t.tlp),null!=t.runtime_configuration&&Object.keys(t.runtime_configuration).length&&n.append("runtime_configuration",JSON.stringify(t.runtime_configuration)),e.abrupt("return",ee.a.post(ae.b,n));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var je=function(e){var t={ip:[],hash:[],domain:[],url:[],generic:[],file:[]};return e.forEach((function(e){"file"===e.type?t.file.push(e):e.observable_supported.forEach((function(n){return t[n].push(e)}))})),t},fe=function(e){return[e.loading,e.error,je(e.analyzers),e.connectors]},me=[{value:"check_all",label:"Do not execute if a similar analysis is currently running or reported without fails"},{value:"running_only",label:"Do not execute if a similar analysis is currently running"},{value:"force_new",label:"Force new analysis"}],Oe={ip:{placeholder:"8.8.8.8",pattern:"((^s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))s*$)|(^s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:)))(%.+)?s*$))"},url:{placeholder:"http://example.com/",pattern:"(www.|http://|https://).*"},domain:{placeholder:"scanme.org",pattern:"^(www)?[.]?[-_a-zA-Z0-9]+([.][a-zA-Z0-9]+)+$"},hash:{placeholder:"446c5fbb11b9ce058450555c1c27153c",pattern:"^[a-zA-Z0-9]{4,}$"},generic:{placeholder:"email, phone no., city, country, registry etc.",pattern:".*"}},he={classification:"ip",observable_name:void 0,file:void 0,analyzers:[],connectors:[],tlp:"WHITE",runtime_configuration:{},tags:[],check:"check_all"};function pe(){console.debug("ScanForm rendered!");var e=o.a.useState(he.classification),t=Object(r.a)(e,2),n=t[0],s=t[1],l=o.a.useState(!1),p=Object(r.a)(l,2),y=p[0],z=p[1],A=o.a.useCallback((function(){return z((function(e){return!e}))}),[z]);x()("IntelOwl | Scan",{restoreOnUnmount:!0});var T=Object(O.g)(),D=function(){var e=Object(w.a)(o.a.useCallback((function(e){return[e.access,e.service.fetchUserAccess]}),[])),t=Object(r.a)(e,2),n=t[0],c=t[1],s=n;return[{MonthBadge:o.a.useCallback((function(e){return Object(F.jsx)(k.a,Object(a.a)(Object(a.a)({},e),{},{className:_()("user-select-none bg-gradient",e.className),children:"Month: ".concat(null===s||void 0===s?void 0:s.month_submissions)}))}),[s]),TotalBadge:o.a.useCallback((function(e){return Object(F.jsx)(k.a,Object(a.a)(Object(a.a)({},e),{},{className:_()("user-select-none bg-gradient",e.className),children:"Total: ".concat(null===s||void 0===s?void 0:s.total_submissions)}))}),[s]),QuotaInfoIcon:o.a.useCallback((function(e){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(g.p,{id:"quota-info-icon"}),Object(F.jsxs)(N.a,{target:"quota-info-icon",placement:"right",fade:!1,innerClassName:"p-2 border border-info text-left text-nowrap md-fit-content",children:["Your Submissions Quota.",Object(F.jsxs)("ul",{children:[Object(F.jsx)("li",{children:"Month submissions doesn't include failed analysis."}),Object(F.jsx)("li",{children:"Total submissions includes all analysis made by you ever."})]})]})]})}),[])},c,s]}(),I=Object(r.a)(D,3),L=I[0],M=L.MonthBadge,P=L.TotalBadge,R=L.QuotaInfoIcon,q=I[1],V=(I[2],Object(w.c)(fe)),B=Object(r.a)(V,4),U=B[0],G=B[1],W=B[2],$=B[3],H=o.a.useMemo((function(){return W[n].map((function(e){return{isDisabled:!e.verification.configured,value:e.name,label:Object(F.jsxs)("div",{className:"d-flex justify-content-start align-items-start flex-column",children:[Object(F.jsxs)("div",{className:"d-flex justify-content-start align-items-baseline flex-column",children:[Object(F.jsxs)("div",{children:[e.name,"\xa0"]}),Object(F.jsx)("div",{className:"small text-left text-muted",children:Object(C.e)(e.description)})]}),!e.verification.configured&&Object(F.jsxs)("div",{className:"small text-danger",children:["\u26a0 ",e.verification.error_message]})]}),labelDisplay:e.name}})).sort((function(e,t){return e.isDisabled===t.isDisabled?0:e.isDisabled?1:-1}))}),[W,n]),Q=o.a.useMemo((function(){return $.map((function(e){return{isDisabled:!e.verification.configured,value:e.name,label:Object(F.jsxs)("div",{className:"d-flex justify-content-start align-items-start flex-column",children:[Object(F.jsxs)("div",{className:"d-flex justify-content-start align-items-baseline flex-column",children:[Object(F.jsxs)("div",{children:[e.name,"\xa0"]}),Object(F.jsx)("div",{className:"small text-left text-muted",children:Object(C.e)(e.description)})]}),!e.verification.configured&&Object(F.jsxs)("div",{className:"small text-danger",children:["\u26a0 ",e.verification.error_message]})]}),labelDisplay:e.name}})).sort((function(e,t){return e.isDisabled===t.isDisabled?0:e.isDisabled?1:-1}))}),[$]),Z=o.a.useCallback((function(e){var t={};if(G&&(t.analyzers=G,t.connectors=G),"file"===e.classification)e.file||(t.file="required");else if(e.observable_name){RegExp(Oe[e.classification].pattern).test(e.observable_name)||(t.observable_name="invalid ".concat(e.classification))}else t.observable_name="required";return S.i.includes(e.tlp)||(t.tlp="Invalid choice"),t}),[G]),Y=o.a.useCallback(function(){var e=Object(c.a)(i.a.mark((function e(t,n){var c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(a.a)(Object(a.a)({},t),{},{tags_labels:t.tags.map((function(e){return e.value.label})),analyzers:t.analyzers.map((function(e){return e.value})),connectors:t.connectors.map((function(e){return e.value}))}),e.prev=1,e.next=4,re(c);case 4:r=e.sent,setTimeout((function(){return T.push("/jobs/".concat(r))}),1e3),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:return e.prev=10,q(),n.setSubmitting(!1),e.finish(10);case 14:case"end":return e.stop()}}),e,null,[[1,8,10,14]])})));return function(t,n){return e.apply(this,arguments)}}(),[T,q]);return Object(F.jsxs)(u.a,{className:"col-lg-12 col-xl-7",children:[Object(F.jsxs)(v.e,{className:"bg-body mb-2 d-flex-center",children:[Object(F.jsx)(M,{className:"mr-2 text-larger"}),Object(F.jsx)(P,{className:"ml-2 mr-3 text-larger"}),Object(F.jsx)(R,{})]}),Object(F.jsxs)(v.e,{id:"ScanForm",className:"mt-3 bg-body shadow",children:[Object(F.jsxs)("h3",{className:"font-weight-bold",children:["Scan\xa0","file"===n?"File":"Observable"]}),Object(F.jsx)("hr",{}),Object(F.jsx)(h.b,{initialValues:he,validate:Z,onSubmit:Y,validateOnMount:!0,children:function(e){return Object(F.jsxs)(h.a,{children:[Object(F.jsx)(d.a,{className:"content-section bg-darker d-flex-center flex-wrap",children:S.a.map((function(t){return Object(F.jsx)(m.a,{inline:!0,id:"classification__".concat(t),type:"radio",name:"classification",label:t,value:t,onClick:function(){s(t),e.setFieldValue("analyzers",[])}},"classification__".concat(t))}))}),S.f.includes(e.values.classification)?Object(F.jsxs)(d.a,{row:!0,children:[Object(F.jsx)(b.a,{className:"required",sm:4,htmlFor:"observable_name",children:"Observable Value"}),Object(F.jsx)(j.a,{sm:8,children:Object(F.jsx)(m.a,Object(a.a)({type:"text",name:"observable_name",className:"form-control input-dark"},Oe[e.values.classification]))})]}):Object(F.jsxs)(d.a,{row:!0,children:[Object(F.jsx)(b.a,{className:"required",sm:4,htmlFor:"file",children:"File"}),Object(F.jsx)(j.a,{sm:8,children:Object(F.jsx)(m.a,{type:"file",name:"file",className:"input-dark"})})]}),Object(F.jsxs)(d.a,{row:!0,children:[Object(F.jsx)(b.a,{sm:4,htmlFor:"analyzers",children:"Select Analyzers"}),Object(F.jsx)(v.r,{loading:U,error:G,render:function(){return Object(F.jsxs)(j.a,{sm:8,children:[Object(F.jsx)(v.v,{options:H,value:e.values.analyzers,onChange:function(t){return e.setFieldValue("analyzers",t)}}),Object(F.jsx)(f.a,{children:"Default: all configured analyzers are triggered."})]})}})]}),Object(F.jsxs)(d.a,{row:!0,children:[Object(F.jsx)(b.a,{sm:4,htmlFor:"connectors",children:"Select Connectors"}),!(U||G)&&Object(F.jsxs)(j.a,{sm:8,children:[Object(F.jsx)(v.v,{options:Q,value:e.values.connectors,onChange:function(t){return e.setFieldValue("connectors",t)}}),Object(F.jsx)(f.a,{children:"Default: all configured connectors are triggered."})]})]}),Object(F.jsxs)(d.a,{row:!0,children:[Object(F.jsx)(b.a,{sm:4,htmlFor:"runtime_configuration",children:"Runtime Configuration"}),Object(F.jsxs)(j.a,{sm:8,children:[Object(F.jsx)(v.p,{id:"scanform-runtimeconf-editbtn",Icon:g.j,title:"Edit runtime configuration",titlePlacement:"top",size:"sm",color:"tertiary",disabled:!(e.values.analyzers.length>0||e.values.connectors.length>0),onClick:A}),y&&Object(F.jsx)(J,{isOpen:y,toggle:A,formik:e})]})]}),Object(F.jsxs)(d.a,{row:!0,children:[Object(F.jsx)(b.a,{sm:4,htmlFor:"tlp",children:"TLP"}),Object(F.jsxs)(j.a,{sm:8,children:[S.i.map((function(e){return Object(F.jsx)(m.a,{inline:!0,id:"tlpchoice__".concat(e),type:"radio",name:"tlp",label:Object(F.jsx)(C.d,{value:e}),value:e},"tlpchoice__".concat(e))})),Object(F.jsx)(f.a,{children:S.k[e.values.tlp].replace("TLP: ","")})]})]}),Object(F.jsxs)(d.a,{row:!0,children:[Object(F.jsx)(b.a,{sm:4,htmlFor:"tags",children:"Tags"}),Object(F.jsx)(j.a,{sm:8,children:Object(F.jsx)(K,{id:"scanform-tagselectinput",selectedTags:e.values.tags,setSelectedTags:function(t){return e.setFieldValue("tags",t,!1)}})})]}),Object(F.jsxs)(d.a,{row:!0,className:"mt-2",children:[Object(F.jsx)(b.a,{sm:4,htmlFor:"check",children:"Extra configuration"}),Object(F.jsx)(j.a,{sm:8,children:me.map((function(e){return Object(F.jsx)(m.a,{id:"checkchoice__".concat(e.value),type:"radio",name:"check",label:e.label,value:e.value},"checkchoice__".concat(e.value))}))})]}),Object(F.jsx)(d.a,{row:!0,className:"mt-5",children:Object(F.jsx)(m.b,{disabled:!(e.isValid||e.isSubmitting),withSpinner:!0,color:"primary",size:"lg",outline:!0,className:"mx-auto rounded-0",children:!e.isSubmitting&&"Start Scan"})})]})}})]}),Object(F.jsx)("h6",{className:"font-weight-bold",children:"Recent Scans"}),Object(F.jsx)(E,{})]})}}}]);